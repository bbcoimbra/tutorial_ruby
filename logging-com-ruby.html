<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>logging com ruby</title>
   <meta name="author" content="" />

   <!--- Blueprint CSS Framework -->
   <link rel="stylesheet" href="css/blueprint/screen.css" type="text/css" media="screen, projection">
   <link rel="stylesheet" href="css/blueprint/print.css" type="text/css" media="print">
   <!--[if IE]>
      <link rel="stylesheet" href="css/blueprint/ie.css" type="text/css" media="screen, projection">
   <![endif]-->

   <!-- CodeRay syntax highlighting CSS -->
   <link rel="stylesheet" href="css/coderay.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="css/site.css" type="text/css" media="screen, projection" />
</head>
<body>

<div class="container">

   <div class="column span-20 prepend-2 append-2 first last" id="header">
     <p class="title">Tutorial de Ruby do GURU-SP</p>
     <hr>
   </div>

   <div class="column span-15 prepend-2 first">
      <p class="title">logging com ruby</p>
<p>The Logger  class in the Ruby standard library, helps write log messages to a file or stream. It supports time- or size-based rolling of log files. Messages can be assigned severities, and only those messages at or above the logger&#8217;s current reporting level will be logged.</p>
<p>When you write code, you simply assume that all the messages will be logged. At runtime, you can get a more or a less verbose log by changing the log level. A production application usually has a log level of Logger::INFO or Logger::WARN. From least to most severe, the instance methods are Logger.debug, Logger.info, Logger.warn, Logger.error, and Logger.fatal.</p>
<p>The DEBUG log level is useful for step-by-step diagnostics of a complex task. The ERROR level is often used when handling exceptions: if the program can&#8217;t solve a problem, it logs the exception rather than crash and expects a human administrator to deal with it. The FATAL level should only be used when the program cannot recover from a problem, and is about to crash or exit.</p>
<p>If your log is being stored in a file, you can have Logger rotate or replace the log file when it gets too big, or once a certain amount of time has elapsed:</p>
<p><code class='ruby'>
  require 'logger'</p>
<ol>
	<li>Keep data for the current month only<br />
  Logger.new(&#8216;this_month.log&#8217;, &#8216;monthly&#8217;)</li>
	<li>Keep data for today and the past 20 days.<br />
  Logger.new(&#8216;application.log&#8217;, 20, &#8216;daily&#8217;)</li>
	<li>Start the log over whenever the log exceeds 100 megabytes in size.<br />
  Logger.new(&#8216;application.log&#8217;, 0, 100 * 1024 * 1024)<br />
</code></li>
</ol>
<p>The code below, uses the application&#8217;s logger to print a debugging message, and (at a higher severity) as part of error-handling code.</p>
<p><code class='ruby'>
  #logex.rb
  require 'logger'
  $LOG = Logger.new('log_file.log', 'monthly')
  def divide(numerator, denominator)
    $LOG.debug("Numerator: #{numerator}, denominator #{denominator}")
    begin
      result = numerator / denominator
    rescue Exception =&gt; e
      $LOG.error "Error in division!: #{e}"
      result = nil
    end
    return result
  end
  divide(10, 2)
</code></p>
<p>The contents of the file log_file.log is:</p>
<p><code class='text'></p>
<ol>
	<li>Logfile created on Tue Mar 18 17:09:29 +0530 2008 by /<br />
  D, [2008-03-18T17:09:29.216000 #2020] DEBUG &#8212; : Numerator: 10, denominator 2<br />
</code></li>
</ol>
<p>Now try to call the method by:</p>
<p><code class='ruby'>
  divide(10, 0)
</code></p>
<p>The contents of the file log_file.log is:</p>
<p><code class='ruby'></p>
<ol>
	<li>Logfile created on Tue Mar 18 17:09:29 +0530 2008 by /<br />
  D, [2008-03-18T17:09:29.216000 #2020] DEBUG &#8212; : Numerator: 10, denominator 2<br />
  D, [2008-03-18T17:13:50.044000 #2820] DEBUG &#8212; : Numerator: 10, denominator 0<br />
  E, [2008-03-18T17:13:50.044000 #2820] ERROR &#8212; : Error in division!: divided by 0<br />
</code></li>
</ol>
<p>To change the log level, simply assign the appropriate constant to level:</p>
<p><code class='ruby'>
  $LOG.level = Logger::ERROR
</code></p>
<p>Now our logger will ignore all log messages except those with severity ERROR or FATAL. The contents of the file log_file.log is:</p>
<p><code class='ruby'>
  E, [2008-03-18T17:15:59.919000 #2624] ERROR -- : Error in division!: divided by 0
</code></p>
   </div>

   <div class="column span-5 append-2 last">

      <p><a href="http://www.guru-sp.org" title="Grupo de Usuários Ruby de SP"><img src="images/logo_guru-sp.jpg" title="Logo do GURU-SP" alt="Logo do Guru-SP" /></a></p>

      <div class="box">
         <p>Este material tem como base o <a href="http://www.rubylearning.com" title="Ruby Learning">tutorial do RubyLearning.com de Satish Talim</a> e foi traduzido por membros do <a href="http://www.guru-sp.org" title="Grupo de Usuários Ruby de SP">GURU-SP</a> com a permissão do autor.</p>
        <p class="last">Ajude o RubyLearning participando em algum dos <a href="http://www.rubylearning.org" title="cursos do Ruby Learning">cursos pagos</a> ou <a href="http://pledgie.com/campaigns/415" title="Ajude o Ruby Learning">fazendo uma doação para o projeto</a></p>
      </div>

      <p class="quiet"><a href="index.html" title="índice">Voltar para o índice</a></p>

      <h5></h5>
      <p class="incr"></p>
   </div>

   <div class="column span-20 prepend-2 append-2 first last" id="footer">
     <hr />
     <p>Tuturial de Ruby do <a href="http://www.guru-sp.org" title="Grupo de Usuários Ruby de SP">GURU-SP</a>. Este site foi criado com <a href="http://webby.rubyforge.org">Webby</a></p>
   </div>

</div>
</body>
</html>
